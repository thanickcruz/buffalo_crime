---
title: "Untitled"
author: "Nicholas Cruz"
date: "2023-11-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### **Random Forest**

```{r}
install.packages(c('randomForest', 'caret'))
```

```{r}
library(randomForest)
library(caret)
```

```{r}
attach(iris)
iris
```

**100 trees**

```{r}
set.seed(1)
k=10
mis.errors.100=rep(k)
iris.splits=createFolds(iris$Species, k = k, returnTrain = FALSE)

for (i in 1:k){
  # split into train/test
  iris.test=iris[iris.splits[[i]],]
  iris.train=iris[-iris.splits[[i]],]
  
  # train model
  iris.rf = randomForest(Species ~ ., data=iris.train, type='classification',importance=TRUE, proximity=TRUE, ntree=100) 
  
  # predict on test and get error from confusion matrix
  predictions=predict(iris.rf, iris.test)
  rf.cm=table(predictions,iris.test$Species)
  mis.error=1-sum(diag(rf.cm))/sum(rf.cm)
  
  mis.errors.100[i]=mis.error
}

mean(mis.errors.100)
```

**500 trees**

```{r}
set.seed(1)
k=10
mis.errors.500=rep(k)
iris.splits=createFolds(iris$Species, k = k, returnTrain = FALSE)

for (i in 1:k){
  # split into train/test
  iris.test=iris[iris.splits[[i]],]
  iris.train=iris[-iris.splits[[i]],]
  
  # train model
  iris.rf = randomForest(Species ~ ., data=iris.train, type='classification',importance=TRUE, proximity=TRUE, ntree=500) 
  
  # predict on test and get error from confusion matrix
  predictions=predict(iris.rf, iris.test)
  rf.cm=table(predictions,iris.test$Species)
  mis.error=1-sum(diag(rf.cm))/sum(rf.cm)
  
  mis.errors.500[i]=mis.error
}

mean(mis.errors.500)
```

**1000 trees**

```{r}
set.seed(1)
k=10
mis.errors.1000=rep(k)
iris.splits=createFolds(iris$Species, k = k, returnTrain = FALSE)

for (i in 1:k){
  # split into train/test
  iris.test=iris[iris.splits[[i]],]
  iris.train=iris[-iris.splits[[i]],]
  
  # train model
  iris.rf = randomForest(Species ~ ., data=iris.train, type='classification',importance=TRUE, proximity=TRUE, ntree=1000) 
  
  # predict on test and get error from confusion matrix
  predictions=predict(iris.rf, iris.test)
  rf.cm=table(predictions,iris.test$Species)
  mis.error=1-sum(diag(rf.cm))/sum(rf.cm)
  
  mis.errors.1000[i]=mis.error
}

mean(mis.errors.1000)
```
